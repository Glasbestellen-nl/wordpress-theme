{"version":3,"file":"admin.js","mappings":"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","sources":["webpack://glasbestellen/./src/admin/index.js"],"sourcesContent":["jQuery(document).ready(function ($) {\n  /**\n   * Change current lead editor\n   */\n  $(window)\n    .on(\"load\", function () {\n      function checkCurrentEditedLeads() {\n        const selector = \".js-someone-editing\";\n        const leadIDs = [];\n        $(selector).each(function (index, element) {\n          leadIDs.push($(element).data(\"lead-id\"));\n        });\n        const data = {\n          action: \"check_leads_current_editor\",\n          lead_ids: leadIDs,\n        };\n        $.get(ajaxurl, data, function (leads) {\n          if (leads) {\n            for (const [id, editing] of Object.entries(leads)) {\n              if (editing) {\n                $(selector + \"-\" + id).fadeIn();\n              } else {\n                $(selector + \"-\" + id).fadeOut();\n              }\n            }\n          }\n        });\n      }\n\n      if (undefined == window.location.search) return;\n\n      const urlParams = new URLSearchParams(window.location.search);\n      const page = urlParams.get(\"page\");\n\n      if (\"crm\" == page) {\n        const leadID = urlParams.get(\"lead_id\");\n\n        // Lead single screen\n        if (leadID) {\n          const data = {\n            action: \"update_lead_current_editor\",\n            lead_id: leadID,\n          };\n          $.post(ajaxurl, data, function (response) {\n            if (response.other_editor) {\n              $(\".js-current-editor-notice\").show();\n            }\n          });\n\n          // CRM table screen\n        } else {\n          checkCurrentEditedLeads();\n          setInterval(checkCurrentEditedLeads, 5000);\n        }\n      }\n    })\n    .unload(function () {\n      const urlParams = new URLSearchParams(window.location.search);\n      const page = urlParams.get(\"page\");\n\n      if (\"crm\" == page) {\n        const leadID = urlParams.get(\"lead_id\");\n        if (leadID) {\n          const data = new FormData();\n          data.append(\"action\", \"unset_lead_current_editor\");\n          data.append(\"lead_id\", leadID);\n          navigator.sendBeacon(ajaxurl, data);\n        }\n      }\n    });\n\n  /**\n   * Confirmation when clicking delete link\n   */\n  $(\".js-lead-row-delete-link\").click(function () {\n    return confirm(gb.msg.sureDeleteLead);\n  });\n\n  /**\n   * Offline conversion tracking dashboard\n   */\n  (function () {\n    const dashboard = $(\".js-conversion-tracking-dashboard\");\n\n    $(dashboard)\n      .on(\"click\", \".js-add-item-button\", function (e) {\n        e.preventDefault();\n        let data = {\n          action: \"get_dashboard_item_row_html\",\n        };\n        $.get(gb.ajaxUrl, data, function (row) {\n          $(\".js-items-table tbody\", dashboard).append(row);\n        });\n      })\n      .on(\"click\", \".js-submit-button\", function (e) {\n        e.preventDefault();\n\n        let self = $(this);\n\n        let leadId = $('[name=\"lead_id\"]').val();\n        let data =\n          $(\":input\", dashboard).serialize() +\n          \"&action=save_dasboard_conversion&lead_id=\" +\n          leadId;\n\n        $.post(gb.ajaxUrl, data, function (response) {});\n      })\n      .on(\"click\", \".js-delete-item-button\", function (e) {\n        e.preventDefault();\n        $(this).parents(\"tr\").remove();\n      });\n  })();\n\n  $(\".js-change-update-lead\").change(updateLead);\n  $(\".js-blur-update-lead\").blur(updateLead);\n  $(\".js-delete-lead\").click(function (e) {\n    e.preventDefault();\n    if (confirm(gb.msg.sureDeleteLead)) {\n      let lead_id = $('[name=\"lead_id\"]').val();\n      let data = {\n        action: \"delete_lead\",\n        lead_id: lead_id,\n      };\n      $.post(gb.ajaxUrl, data, function (redirect) {\n        window.location.replace(redirect);\n      });\n    }\n  });\n  $(\".js-conversion-tracking-settings\").on(\n    \"click\",\n    \".js-add-item-button\",\n    function (e) {\n      e.preventDefault();\n    }\n  );\n\n  function updateLead(callback) {\n    const data = $(\".js-lead-form\").serialize() + \"&action=update_lead\";\n    $.post(gb.ajaxUrl, data, function (response) {\n      callback();\n    });\n  }\n\n  $(\".js-toggle-target\").on(\"click\", function (e) {\n    e.preventDefault();\n    let target = $(this).data(\"toggle-target\");\n    $(target).slideToggle();\n  });\n\n  $(function () {\n    var enabled = true;\n    $(\"textarea.js-tab-support\").keydown(function (e) {\n      // Escape key toggles tab on/off\n      if (e.keyCode == 27) {\n        enabled = !enabled;\n        return false;\n      }\n\n      // Enter Key?\n      if (e.keyCode === 13 && enabled) {\n        // selection?\n        if (this.selectionStart == this.selectionEnd) {\n          // find start of the current line\n          var sel = this.selectionStart;\n          var text = $(this).val();\n          while (sel > 0 && text[sel - 1] != \"\\n\") sel--;\n\n          var lineStart = sel;\n          while (text[sel] == \" \" || text[sel] == \"\\t\") sel++;\n\n          if (sel > lineStart) {\n            // Insert carriage return and indented text\n            document.execCommand(\n              \"insertText\",\n              false,\n              \"\\n\" + text.substr(lineStart, sel - lineStart)\n            );\n\n            // Scroll caret visible\n            this.blur();\n            this.focus();\n            return false;\n          }\n        }\n      }\n\n      // Tab key?\n      if (e.keyCode === 9 && enabled) {\n        // selection?\n        if (this.selectionStart == this.selectionEnd) {\n          // These single character operations are undoable\n          if (!e.shiftKey) {\n            document.execCommand(\"insertText\", false, \"\\t\");\n          } else {\n            var text = this.value;\n            if (\n              this.selectionStart > 0 &&\n              text[this.selectionStart - 1] == \"\\t\"\n            ) {\n              document.execCommand(\"delete\");\n            }\n          }\n        } else {\n          // Block indent/unindent trashes undo stack.\n          // Select whole lines\n          var selStart = this.selectionStart;\n          var selEnd = this.selectionEnd;\n          var text = $(this).val();\n          while (selStart > 0 && text[selStart - 1] != \"\\n\") selStart--;\n          while (selEnd > 0 && text[selEnd - 1] != \"\\n\" && selEnd < text.length)\n            selEnd++;\n\n          // Get selected text\n          var lines = text.substr(selStart, selEnd - selStart).split(\"\\n\");\n\n          // Insert tabs\n          for (var i = 0; i < lines.length; i++) {\n            // Don't indent last line if cursor at start of line\n            if (i == lines.length - 1 && lines[i].length == 0) continue;\n\n            // Tab or Shift+Tab?\n            if (e.shiftKey) {\n              if (lines[i].startsWith(\"\\t\")) lines[i] = lines[i].substr(1);\n              else if (lines[i].startsWith(\"    \"))\n                lines[i] = lines[i].substr(4);\n            } else lines[i] = \"\\t\" + lines[i];\n          }\n          lines = lines.join(\"\\n\");\n\n          // Update the text area\n          this.value = text.substr(0, selStart) + lines + text.substr(selEnd);\n          this.selectionStart = selStart;\n          this.selectionEnd = selStart + lines.length;\n        }\n\n        return false;\n      }\n      enabled = true;\n      return true;\n    });\n  });\n});\n"],"names":["jQuery","document","ready","$","window","on","checkCurrentEditedLeads","selector","leadIDs","each","index","element","push","data","action","lead_ids","get","ajaxurl","leads","id","editing","Object","entries","fadeIn","fadeOut","undefined","location","search","urlParams","URLSearchParams","page","leadID","lead_id","post","response","other_editor","show","setInterval","unload","FormData","append","navigator","sendBeacon","click","confirm","gb","msg","sureDeleteLead","dashboard","e","preventDefault","ajaxUrl","row","self","leadId","val","serialize","parents","remove","change","updateLead","blur","redirect","replace","callback","target","slideToggle","enabled","keydown","keyCode","selectionStart","selectionEnd","sel","text","lineStart","execCommand","substr","focus","shiftKey","value","selStart","selEnd","length","lines","split","i","startsWith","join"],"sourceRoot":""}